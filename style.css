/* ==========================================================================
   Variables de Tema y Estilos Base
   ========================================================================== */
:root {
    --sidebar-width: 240px;
    --font-family-base: 'Roboto', sans-serif;
    --font-family-mono: 'Roboto Mono', monospace;
    --primary-color: #003366;
    --primary-color-dark: #002244;
    --primary-color-light: #d6e4f0;
    --header-bg: #ffffff;
    --sidebar-bg: linear-gradient(180deg, var(--primary-color) 0%, var(--primary-color-dark) 100%);
    --body-bg: #f4f7fc;
    --card-bg: #ffffff;
    --text-color: #343a40;
    --text-muted-color: #6c757d;
    --border-color: #dee2e6;
    --shadow-color: rgba(0, 0, 0, 0.05);
    --tech-table-bg: rgba(255, 255, 255, 0.7);
}

body.dark-mode {
    --primary-color: #4dabf7;
    --primary-color-dark: #1e88e5;
    --primary-color-light: #2c3e50;
    --header-bg: #1e2a38;
    --sidebar-bg: linear-gradient(180deg, #1e2a38 0%, #151d27 100%);
    --body-bg: #151d27;
    --card-bg: #1e2a38;
    --text-color: #e8eaed;
    --text-muted-color: #9aa0a6;
    --border-color: #3c4043;
    --shadow-color: rgba(0, 0, 0, 0.2);
    --tech-table-bg: rgba(30, 42, 56, 0.7);
}

body {
    font-family: var(--font-family-base);
    background-color: var(--body-bg);
    color: var(--text-color);
    overflow-x: hidden;
    transition: background-color 0.3s, color 0.3s;
}

/* ==========================================================================
   Login
   ========================================================================== */
.login-screen { background-image: url('https://images.unsplash.com/photo-1569154941061-e231b4725ef1?q=80&w=2070'); background-size: cover; background-position: center; display: flex; justify-content: center; align-items: center; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; }
.login-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 20, 0.6); }
.login-container { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(8px); border-radius: 15px; padding: 2.5rem; width: 90%; max-width: 450px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); text-align: center; z-index: 1; border: 1px solid rgba(255, 255, 255, 0.2); }
.login-logo { width: 90px; height: 90px; object-fit: contain; margin-bottom: 1rem; border-radius: 50%; border: 4px solid #003366; padding: 5px; background: #f8f9fa; }
#login-title { font-family: var(--font-family-mono); font-weight: bold; color: #002244; border-right: 3px solid #002244; white-space: nowrap; overflow: hidden; display: inline-block; margin: 0 auto 0.5rem; letter-spacing: .1em; animation: typing 3s steps(15, end), blink-caret .75s step-end infinite; }
@keyframes typing { from { width: 0 } to { width: 100% } }
@keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #002244; } }
#login-button { transition: background-color 0.3s, transform 0.2s; }
#login-button:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0, 51, 102, 0.3); }
#login-button .spinner { display: none; width: 1.2rem; height: 1.2rem; border: 2px solid #fff; border-bottom-color: transparent; border-radius: 50%; animation: rotation 1s linear infinite; margin: 0 auto; }
#login-button.loading .spinner { display: block; }
#login-button.loading .btn-text { display: none; }
@keyframes rotation { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* ==========================================================================
   Animación de Avión CSS con Estela
   ========================================================================== */
#flying-plane { position: absolute; top: 50%; left: -100px; z-index: 1; animation: fly-arc 30s linear infinite; pointer-events: none; opacity: 0.6; width: 25px; height: 8px; background: var(--text-muted-color); border-radius: 40%; }
#flying-plane::before, #flying-plane::after { content: ''; position: absolute; background: var(--text-muted-color); }
#flying-plane::before { width: 8px; height: 22px; left: 7px; top: -9px; transform: skew(-30deg, -10deg); border-radius: 3px; }
#flying-plane::after { width: 5px; height: 10px; left: -2px; top: -1px; transform: skew(40deg, 20deg); border-radius: 1px; }
.contrail { position: absolute; width: 150px; height: 2px; background: linear-gradient(to left, transparent, var(--text-muted-color)); top: 50%; right: 100%; transform: translateY(-50%); opacity: 0.8; }
@keyframes fly-arc { 0% { transform: translate(0, 0) rotate(15deg); } 30% { transform: translate(35vw, -80px) rotate(-10deg); } 70% { transform: translate(75vw, -80px) rotate(-10deg); } 100% { transform: translate(110vw, 20px) rotate(15deg); } }

.header { position: relative; overflow: hidden; }
.header-content { position: relative; z-index: 2; }

/* ==========================================================================
   Tablas de Inicio "Glassmorphism"
   ========================================================================== */
.table-container-tech { background-color: var(--tech-table-bg); backdrop-filter: blur(10px); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; box-shadow: 0 4px 15px var(--shadow-color); overflow: hidden; }
.table-container-tech .table-responsive { max-height: 350px; overflow-y: auto; }
.table-container-tech table { --bs-table-color: var(--text-color); --bs-table-bg: transparent; --bs-table-border-color: var(--border-color); --bs-table-hover-color: var(--text-color); --bs-table-hover-bg: var(--body-bg); }
.table-container-tech thead th { background-color: rgba(0,0,0,0.05); border-bottom: 2px solid var(--primary-color) !important; text-transform: uppercase; font-size: 0.8rem; font-weight: 500; }
body.dark-mode .table-container-tech thead th { background: linear-gradient(to bottom, rgba(255,255,255,0.1), rgba(0,0,0,0.1)); }
.table-container-tech tbody tr { transition: background-color 0.2s, transform 0.2s, border-left-color 0.2s; border-left: 4px solid var(--airline-color, transparent); }
.table-container-tech tbody tr:hover { transform: translateY(-2px) scale(1.01); box-shadow: 0 4px 10px rgba(0,0,0,0.1); background-color: var(--body-bg); }
.table-container-tech .airline-dot { width: 8px; height: 8px; vertical-align: middle; border-radius: 50%; margin-right: 8px; display: inline-block;}

/* ==========================================================================
   Barra Lateral Plegable
   ========================================================================== */
.app-body { position: relative; }
.sidebar { position: fixed; left: 0; top: 0; bottom: 0; transform: translateX(0); transition: transform 0.4s ease; }
.main-content { margin-left: var(--sidebar-width); transition: margin-left 0.4s ease, width 0.4s ease; width: calc(100% - var(--sidebar-width)); }
.sidebar-toggler-btn { color: var(--text-color); border: none; font-size: 1.2rem; }
body.sidebar-collapsed .sidebar { transform: translateX(calc(-1 * var(--sidebar-width))); }
body.sidebar-collapsed .main-content { margin-left: 0; width: 100%; }

/* ==========================================================================
   Animaciones Generales
   ========================================================================== */
.animated-row { opacity: 0; transform-origin: top; transform: rotateX(-90deg); animation: flipIn 0.8s ease-out forwards; animation-delay: var(--delay); }
@keyframes flipIn { to { opacity: 1; transform: rotateX(0deg); } }
.fade-in-row { opacity: 0; animation: fadeInUp 0.8s ease-out forwards; animation-delay: var(--delay); }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* ==========================================================================
   Resto de Estilos
   ========================================================================== */
body.dark-mode .card h1, body.dark-mode .card h2, body.dark-mode .card h3, body.dark-mode .card h4, body.dark-mode .card h5, body.dark-mode .h5 { color: var(--text-color); }
.hidden { display: none !important; }
.aifa-logo { width: 140px; }
.header-logo { height: 45px; }
.main-title { font-size: 1.4rem; font-weight: 500; color: var(--text-color); }
.current-user-display { color: var(--primary-color); }
.gob-logo { height: 35px; }
.formal-clock-container { text-align: center; background-color: var(--body-bg); padding: 0.5rem 1rem; border-radius: 0.5rem; border: 1px solid var(--border-color); }
.clock-label { font-size: 0.7rem; font-weight: 600; color: var(--text-muted-color); text-transform: uppercase; }
.formal-clock { font-family: 'Courier New', monospace; font-weight: 700; font-size: 1.05rem; color: var(--primary-color); }
/* UTC clock styling - same size as local clock */
.utc-clock { font-family: 'Courier New', monospace; font-weight: 700; font-size: 1.05rem; color: var(--primary-color); }
.utc-clock-container .clock-label { font-size: 0.65rem; }

/* Clocks wrapper adjustments - make both clocks visually identical */
.clocks-wrapper .formal-clock-container, .clocks-wrapper .utc-clock-container { background: transparent; padding: 0.18rem 0.45rem; border-radius: 0.4rem; }
.formal-clock, .utc-clock { padding: 0.18rem 0.6rem; border-radius: 6px; background: rgba(255,255,255,0.92); color: #002244; box-shadow: 0 2px 6px rgba(0,0,0,0.06); }

body.dark-mode .formal-clock, body.dark-mode .utc-clock { background: rgba(255,255,255,0.04); color: #e8eaed; box-shadow: none; }

/* Improve contrast in dark mode across the app for text-heavy areas */
body.dark-mode { color: #e8eaed; }
body.dark-mode .card, body.dark-mode .filter-container { background-color: #1e2a38; border-color: rgba(255,255,255,0.06); }
body.dark-mode .menu-item { color: rgba(255,255,255,0.95); }
body.dark-mode .menu-item:hover { background-color: rgba(255,255,255,0.05); }
body.dark-mode .table-container-tech { background-color: rgba(255,255,255,0.04); }

.update-note { font-size: 0.9rem; color: var(--text-muted-color); display: inline-flex; align-items: center; gap: 0.5rem; }
.update-note i { color: var(--primary-color); }
body.dark-mode .update-note { color: #c9d6e6; }
.date-bar { background-color: var(--card-bg); border-bottom: 1px solid var(--border-color); }
.theme-toggle-btn { color: var(--text-color); }
.sidebar { background: var(--sidebar-bg); color: white; width: var(--sidebar-width); flex-shrink: 0; z-index: 1050; }
.menu-item { display: flex; align-items: center; padding: 0.85rem 1.5rem; color: rgba(255, 255, 255, 0.8); text-decoration: none; transition: all 0.2s ease; border-left: 4px solid transparent; }
.menu-item:hover { background-color: rgba(255, 255, 255, 0.1); color: white; }
.menu-item.active { background-color: var(--primary-color-light); color: var(--primary-color-dark); font-weight: 700; border-left-color: var(--primary-color); }
body.dark-mode .menu-item.active { background-color: var(--primary-color-light); color: white; border-left-color: var(--primary-color); }
.menu-item i { margin-right: 12px; width: 20px; text-align: center; }
/* Composite icon for punctuality: clock with a small check overlay */
.icon-clock-check { position: relative; display: inline-block; width: 20px; height: 20px; margin-right: 12px; color: rgba(255,255,255,0.9); }
.icon-clock-check i { position: absolute; left: 0; top: 0; width: 100%; height: 100%; line-height: 20px; text-align: center; }
.icon-clock-check i.check { font-size: 0.65rem; color: #fff; background: #198754; border-radius: 50%; width: 12px; height: 12px; display: inline-flex; align-items: center; justify-content: center; right: -2px; top: 8px; position: absolute; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
body.dark-mode .icon-clock-check { color: #e8eaed; }
.logout-item { margin-top: auto; border-top: 1px solid rgba(255, 255, 255, 0.2); }
.filter-container { background-color: var(--body-bg); border: 1px solid var(--border-color); border-radius: 0.5rem; padding: 1rem; box-shadow: var(--shadow-color) 0px 2px 8px 0px; }
.filter-header { display: flex; align-items: center; color: var(--primary-color); margin-bottom: 0.75rem; }
.pdf-preview-container { position: relative; width: 100%; height: 550px; border: 1px solid var(--border-color); border-radius: .375rem; overflow: hidden; }
.pdf-preview-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
.content-section { display: none; animation: fadeIn 0.5s; }
.content-section.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
.card { background-color: var(--card-bg); border: 1px solid var(--border-color); transition: background-color 0.3s, border-color 0.3s; }
.card-header, .card-body, .card-footer { background-color: transparent; border-color: var(--border-color); }
.nav-tabs .nav-link { color: var(--text-muted-color); }
.nav-tabs .nav-link.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
.table-stylish thead { background-color: var(--primary-color); color: white; font-weight: 500; text-transform: uppercase; font-size: 0.8rem; }
.table-stylish-footer { background-color: var(--primary-color-light); font-weight: bold; color: var(--primary-color-dark); border-top: 2px solid var(--primary-color); }
body.dark-mode .table-stylish-footer { color: var(--text-color); }
.table-dark { --bs-table-bg: var(--primary-color); }
.table-total-row { background-color: var(--primary-color-light); font-weight: bold; }
.pdf-container { position: relative; }
.pdf-container iframe { background: #fff; }
/* Improve contrast for PDF/iframe containers in dark mode so text inside PDFs is easier to read against a white backdrop */
body.dark-mode .pdf-container, body.dark-mode .pdf-preview-container {
   background: #fff;
   border: 1px solid var(--border-color);
   border-radius: .375rem;
   padding: 6px;
}
body.dark-mode .pdf-container iframe, body.dark-mode .pdf-preview-container iframe {
   background: #fff;
}
body.dark-mode .pdf-zoom-btn { background-color: rgba(255,255,255,0.08); color: var(--text-color); }
.pdf-zoom-btn { position: absolute; top: 10px; right: 10px; z-index: 10; background-color: rgba(0, 0, 0, 0.5); color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; text-decoration: none; transition: background-color 0.2s ease; }
.pdf-zoom-btn:hover { background-color: var(--primary-color); color: white; }
.pdf-lightbox { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); z-index: 3000; display: flex; justify-content: center; align-items: center; padding: 1rem; }
.lightbox-content { width: 100%; height: 100%; max-width: 1200px; }
.lightbox-content iframe { width: 100%; height: 100%; border: 2px solid white; }
.lightbox-close { position: absolute; top: 15px; right: 25px; font-size: 2.5rem; color: white; background: none; border: none; cursor: pointer; }
.sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1040; opacity: 0; visibility: hidden; transition: opacity 0.3s ease-in-out; }
.sidebar-overlay.active { opacity: 1; visibility: visible; }

@media (max-width: 991.98px) {
    #flying-plane { display: none; }
    .header .container-fluid > .d-flex { flex-wrap: wrap; justify-content: space-between; }
    .header-center-content { order: 3; width: 100%; text-align: center; padding-top: 1rem; }
    .main-title { font-size: 1rem; }
    .header-logo, .gob-logo { display: none; }
    .formal-clock-container { flex-grow: 1; text-align: right; }
    .sidebar { transform: translateX(calc(-1 * var(--sidebar-width))); } /* Oculto por defecto en móvil */
    .sidebar.visible { transform: translateX(0); box-shadow: 4px 0 15px rgba(0,0,0,0.2); }
    .main-content { margin-left: 0; width: 100%; height: calc(100vh - 170px); padding: 1rem; }
}
@media (max-width: 576px) {
    .main-title { font-size: 0.9rem; }
    .aifa-logo { width: 100px; }
    .formal-clock-container { display: none; }
}