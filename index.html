<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Operaciones AIFA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="login-screen" class="login-screen">
        <div class="login-overlay"></div>
            <div class="login-container">
            <div class="login-header">
                <img src="images/emblema-aviacion.png" alt="Emblema de la Aviación" class="login-logo" />
                <h1 id="login-title" class="h3">OPERACIONES AIFA</h1>
                <p class="text-muted">Ingrese sus credenciales para continuar</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="username" name="username" required placeholder="Ingrese su usuario">
                    <label for="username">Usuario</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="password" class="form-control" id="password" name="password" required placeholder="Ingrese su contraseña">
                    <label for="password">Contraseña</label>
                </div>
                <button type="submit" id="login-button" class="btn btn-primary w-100 py-2">
                    <span class="btn-text">Iniciar Sesión</span>
                    <span class="spinner"></span>
                </button>
                <div id="login-error" class="text-danger mt-2"></div>
            </form>
                                                </div>
    </div>

    <div id="main-app" class="main-app hidden">
        <header class="header p-3">
            <div id="flying-plane"><div class="contrail"></div></div>
            <div class="container-fluid">
                <div class="header-content d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                         <button class="btn sidebar-toggler-btn" type="button" id="sidebar-toggler">
                            <i class="fas fa-bars"></i>
                        </button>
                        <img src="images/aifa-logo.jpg" alt="Logo AIFA" class="aifa-logo" />
                    </div>
                    <div class="text-center header-center-content">
                        <div class="d-flex align-items-center justify-content-center gap-3">
                            <img src="images/nlu-operacion.png" alt="Logo de Operación NLU" class="header-logo" />
                            <h1 class="main-title">AEROPUERTO INTERNACIONAL FELIPE ÁNGELES</h1>
                            <img src="images/emblema-aviacion.png" alt="Logo de Aviación" class="header-logo" />
                        </div>
                        <div id="current-user" class="current-user-display fw-bold mt-2"></div>
                    </div>
                    <div class="d-flex align-items-center gap-3 header-right-content">
                        <div class="clocks-wrapper d-flex gap-2 align-items-center">
                            <div class="formal-clock-container">
                                <div class="clock-label">HORA LOCAL</div>
                                <div class="formal-clock" id="formal-clock">00:00:00</div>
                            </div>
                            <div class="utc-clock-container">
                                <div class="clock-label">HORA UTC</div>
                                <div class="utc-clock" id="utc-clock">00:00:00</div>
                            </div>
                        </div>
                        <img src="images/gobierno-mexico.png" alt="Logo del Gobierno de México" class="gob-logo" />
                        <button id="theme-toggler" class="btn theme-toggle-btn" title="Cambiar tema">
                            <i class="fas fa-moon"></i>
                        </button>
                        <a href="#" class="btn btn-outline-danger d-lg-none logout-button-mobile" data-action="logout" title="Cerrar Sesión">
                            <i class="fas fa-sign-out-alt"></i>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <div class="date-bar text-center p-2">
            <p id="current-date" class="m-0 fw-bold"></p>
        </div>

        <div class="app-body">
            <aside class="sidebar d-flex flex-column p-2" id="sidebar">
                <nav class="nav flex-column" id="sidebar-nav">
                    <a class="menu-item active" href="#" data-section="inicio"><i class="fas fa-home"></i><span>Inicio</span></a>
                    <a class="menu-item" href="#" data-section="itinerario"><i class="fas fa-calendar-alt"></i><span>Itinerario</span></a>
                    <a class="menu-item" href="#" data-section="parte-operaciones"><i class="fas fa-file-invoice"></i><span>Parte de Operaciones</span></a>
                        <a class="menu-item" href="#" data-section="puntualidad-agosto">
                            <span class="icon-clock-check" aria-hidden="true">
                                <i class="fas fa-clock"></i>
                                <i class="fas fa-check check" aria-hidden="true"></i>
                            </span>
                            <span>Puntualidad</span>
                        </a>
                    <a class="menu-item" href="#" data-section="demoras"><i class="fas fa-clock"></i><span>Demoras</span></a>
                    <a class="menu-item" href="#" data-section="operaciones-totales"><i class="fas fa-clipboard-check"></i><span>Operaciones Totales</span></a>
                    <a class="menu-item" id="itinerario-mensual-menu" href="#" data-section="itinerario-mensual"><i class="fas fa-table"></i><span>Itinerario Mensual (Octubre)</span></a>
                    <a class="menu-item" href="#" data-section="comparativa"><i class="fas fa-chart-line"></i><span>Comparativa</span></a>
                    <a class="menu-item logout-item" href="#" data-action="logout"><i class="fas fa-sign-out-alt"></i><span>Cerrar Sesión</span></a>
                </nav>
            </aside>
            <div class="sidebar-overlay" id="sidebar-overlay"></div>

            <main class="main-content flex-grow-1 p-3 p-md-4">
                
                <div id="inicio-section" class="content-section active">
                    <div class="card">
                        <div class="card-header">
                            <ul class="nav nav-tabs card-header-tabs" id="inicioTab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="interactivo-inicio-tab" data-bs-toggle="tab" data-bs-target="#interactivo-inicio-pane" type="button" role="tab" aria-controls="interactivo-inicio-pane" aria-selected="true"><i class="fas fa-table me-2"></i>Vista Interactiva</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="pdf-inicio-tab" data-bs-toggle="tab" data-bs-target="#pdf-inicio-pane" type="button" role="tab" aria-controls="pdf-inicio-pane" aria-selected="false"><i class="fas fa-file-pdf me-2"></i>Documento PDF Original</button>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content" id="inicioTabContent">
                                <div class="tab-pane fade show active" id="interactivo-inicio-pane" role="tabpanel" aria-labelledby="interactivo-inicio-tab" tabindex="0">
                                    <div class="row">
                                        <div class="col-12 col-lg-4 mb-4 mb-lg-0">
                                            <h4 class="mb-3"><i class="fas fa-list-ul me-2"></i>Resumen por Aerolínea</h4>
                                            <div id="summary-table-container" class="table-container-tech"></div>
                                        </div>
                                        <div class="col-12 col-lg-8">
                                            <div id="filter-controls" class="filter-container mb-4">
                                                <div class="filter-header">
                                                    <i class="fas fa-filter me-2"></i>
                                                    <h5 class="mb-0">Filtros de Búsqueda</h5>
                                                </div>
                                                <div class="input-group">
                                                        <select id="airline-filter" class="form-select">
                                                            <option value="all" selected>Todas las Aerolíneas</option>
                                                        </select>
                                                        <input type="text" id="claim-filter" class="form-control" placeholder="Filtrar por banda de reclamo...">
                                                    </div>
                                                    <div class="mt-2 d-flex gap-2 flex-wrap align-items-center">
                                                        <div class="input-group input-group-sm" style="min-width:220px;">
                                                            <label class="input-group-text">Posición</label>
                                                            <select id="position-filter" class="form-select">
                                                                <option value="all" selected>Todas las posiciones</option>
                                                            </select>
                                                        </div>
                                                        <div style="min-width:200px;">
                                                            <!-- Búsqueda global de texto: aerolínea, origen, destino, vuelo, banda, etc. -->
                                                            <input type="text" id="global-search" class="form-control form-control-sm" placeholder="Buscar texto (aerolinea/origen/destino/vuelo/banda)...">
                                                        </div>
                                                        <div class="mt-2">
                                                            <button id="clear-filters" class="btn btn-outline-secondary btn-sm">Limpiar filtros</button>
                                                        </div>
                                                    </div>
                                            </div>
                                            <h4 class="mb-3"><i class="fas fa-plane-departure me-2"></i>Itinerario de Pasajeros</h4>
                                            <div id="passenger-itinerary-container" class="table-container-tech mb-4"></div>
                                            
                                            <h4 class="mb-3 mt-4"><i class="fas fa-truck-ramp-box me-2"></i>Itinerario de Carga</h4>
                                            <div id="cargo-itinerary-container" class="table-container-tech"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="pdf-inicio-pane" role="tabpanel" aria-labelledby="pdf-inicio-tab" tabindex="0">
                                      <div class="pdf-container">
                                        <a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a>
                                        <iframe src="pdfs/Itinerario.pdf" width="100%" height="700px" class="border-0"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="itinerario-section" class="content-section">
                    <div class="card">
                        <div class="card-header flex-column flex-md-row d-flex justify-content-between align-items-center">
                            <h2 class="mb-3 mb-md-0">ITINERARIO DETALLADO</h2>
                            <div class="d-flex gap-2">
                                <a href="pdfs/itinerario_completo.pdf" class="btn btn-danger download-btn" download><i class="fas fa-file-pdf me-2"></i><span class="btn-text">Descargar PDF</span></a>
                                <a href="excel/itinerario_completo.xlsx" class="btn btn-success download-btn" download><i class="fas fa-file-excel me-2"></i><span class="btn-text">Descargar Excel</span></a>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- (Removed) Resumen rápido por aerolínea: se elimina para mostrar solo los PDFs en Itinerario Detallado -->
                            <ul class="nav nav-tabs" id="itineraryTab" role="tablist">
                                <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#pasajeros-calor-pane">1. Mapa de Calor (Pasajeros)</button></li>
                                <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#pasajeros-grafica-pane">2. Gráfica (Pasajeros)</button></li>
                                <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#carga-calor-pane">3. Mapa de Calor (Carga)</button></li>
                                <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#carga-grafica-pane">4. Gráfica (Carga)</button></li>
                            </ul>
                            <div class="tab-content pt-3" id="itineraryTabContent">
                                <div class="tab-pane fade show active" id="pasajeros-calor-pane"><div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/mapa_calor_pasajeros.pdf" width="100%" height="700px" class="border-0"></iframe></div></div>
                                <div class="tab-pane fade" id="pasajeros-grafica-pane"><div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/grafica_pasajeros.pdf" width="100%" height="700px" class="border-0"></iframe></div></div>
                                <div class="tab-pane fade" id="carga-calor-pane"><div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/mapa_calor_carga.pdf" width="100%" height="700px" class="border-0"></iframe></div></div>
                                <div class="tab-pane fade" id="carga-grafica-pane"><div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/grafica_carga.pdf" width="100%" height="700px" class="border-0"></iframe></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="parte-operaciones-section" class="content-section">
                    <div class="card">
                        <div class="card-header flex-column flex-md-row d-flex justify-content-between align-items-center">
                            <h2 class="mb-3 mb-md-0">Resumen de operaciones del día 30 de septiembre de 2025</h2>
                            <div class="d-flex gap-2">
                                <a href="pdfs/parte_operaciones_completo.pdf" class="btn btn-danger download-btn" download><i class="fas fa-file-pdf me-2"></i><span class="btn-text">Descargar PDF</span></a>
                                <a href="excel/parte_operaciones_completo.xlsx" class="btn btn-success download-btn" download><i class="fas fa-file-excel me-2"></i><span class="btn-text">Descargar Excel</span></a>
                            </div>
                        </div>
                        <div class="card-body">
                            <ul class="nav nav-tabs" id="operationsTab" role="tablist">
                                <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#resumen1-pane">Resumen 1</button></li>
                                <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#resumen2-pane">Resumen 2</button></li>
                            </ul>
                            <div class="tab-content pt-3" id="operationsTabContent">
                                <div class="tab-pane fade show active" id="resumen1-pane">
                                    <div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/resumen_1.pdf" width="100%" height="700px" class="border-0"></iframe></div>
                                </div>
                                <div class="tab-pane fade" id="resumen2-pane">
                                    <div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/resumen_2.pdf" width="100%" height="700px" class="border-0"></iframe></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="demoras-section" class="content-section">
                    <div class="card">
                        <div class="card-header"><h2 class="mb-0" id="demoras-title">Análisis de Demoras</h2></div>
                        <div class="card-body">
                            <div class="mb-4">
                                <h3 class="h5 text-center mb-3">Demoras en vuelos de salida</h3>
                                <div class="table-responsive">
                                    <table class="table table-bordered text-center">
                                        <thead class="table-dark"><tr><th>Causa</th><th>Demoras</th><th>Porcentaje</th></tr></thead>
                                        <tbody id="demoras-tbody"></tbody>
                                        <tfoot id="demoras-tfoot"></tfoot>
                                    </table>
                                </div>
                            </div>
                            <div class="chart-container" style="height: 400px;"><canvas id="delaysChart"></canvas></div>
                        </div>
                    </div>
                </div>

                <div id="operaciones-totales-section" class="content-section">
                    <div class="card">
                        <div class="card-header"><h2 class="mb-0">Operaciones Totales (Comparación 2022-2024) </h2></div>
                        <div class="card-body">
                            <ul class="nav nav-tabs" id="opTotalesTab" role="tablist">
                                <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#resumen-tablas-pane">Resumen de Operaciones</button></li>
                                <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#informe-estadistico-pane">Informe Estadístico</button></li>
                            </ul>
                            <div class="tab-content pt-3" id="opTotalesTabContent">
                                <div class="tab-pane fade show active" id="resumen-tablas-pane">
                                    <div class="card-op-container card border-0 shadow-sm mb-4">
                                        <div class="card-header bg-transparent d-flex align-items-center"><i class="fas fa-plane-departure fa-2x text-primary me-3"></i><h3 class="mb-0 h5">Aviación Comercial</h3></div>
                                        <div class="card-body"><div class="row align-items-center"><div class="col-lg-6"><div class="table-responsive">
                                            <table class="table table-stylish">
                                                <thead><tr><th class="text-start">PERIODO</th><th class="text-end">OPERACIONES</th><th class="text-end">PASAJEROS</th></tr></thead>
                                                <tbody id="comercial-ops-tbody"></tbody>
                                                <tfoot class="table-stylish-footer">
                                                    <tr>
                                                        <td class="text-start">TOTAL (Histórico)</td>
                                                        <td class="text-end" id="total-comercial-ops">0</td>
                                                        <td class="text-end" id="total-comercial-pax">0</td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div></div><div class="col-lg-6"><div class="chart-container" style="height: 300px;"><canvas id="commercialOpsChart"></canvas></div></div></div></div>
                                    </div>
                                    <div class="card-op-container card border-0 shadow-sm mb-4">
                                        <div class="card-header bg-transparent d-flex align-items-center"><i class="fas fa-box-open fa-2x text-primary me-3"></i><h3 class="mb-0 h5">Operaciones de Carga</h3></div>
                                        <div class="card-body"><div class="row align-items-center"><div class="col-lg-6"><div class="table-responsive">
                                            <table class="table table-stylish">
                                                <thead><tr><th class="text-start">PERIODO</th><th class="text-end">OPERACIONES</th><th class="text-end">TONELADAS</th></tr></thead>
                                                <tbody id="cargo-ops-tbody"></tbody>
                                                <tfoot class="table-stylish-footer">
                                                    <tr>
                                                        <td class="text-start">TOTAL (Histórico)</td>
                                                        <td class="text-end" id="total-cargo-ops">0</td>
                                                        <td class="text-end" id="total-cargo-tons">0</td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div></div><div class="col-lg-6"><div class="chart-container" style="height: 300px;"><canvas id="cargoOpsChart"></canvas></div></div></div></div>
                                    </div>
                                    <div class="card-op-container card border-0 shadow-sm">
                                        <div class="card-header bg-transparent d-flex align-items-center"><i class="fas fa-plane fa-2x text-primary me-3"></i><h3 class="mb-0 h5">Aviación General</h3></div>
                                        <div class="card-body"><div class="row align-items-center"><div class="col-lg-6"><div class="table-responsive">
                                            <table class="table table-stylish">
                                                <thead><tr><th class="text-start">PERIODO</th><th class="text-end">OPERACIONES</th><th class="text-end">PASAJEROS</th></tr></thead>
                                                <tbody id="general-ops-tbody"></tbody>
                                                <tfoot class="table-stylish-footer">
                                                    <tr>
                                                        <td class="text-start">TOTAL (Histórico)</td>
                                                        <td class="text-end" id="total-general-ops">0</td>
                                                        <td class="text-end" id="total-general-pax">0</td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div></div><div class="col-lg-6"><div class="chart-container" style="height: 300px;"><canvas id="generalOpsChart"></canvas></div></div></div></div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="informe-estadistico-pane"><div class="pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/informe_estadistico.pdf" width="100%" height="700px" class="border-0"></iframe></div></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="itinerario-mensual-section" class="content-section">
                    <div class="card"><div class="card-header text-center"><h2 class="mb-0">ITINERARIO MENSUAL (OCTUBRE) </h2></div><div class="card-body pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/itinerario_mensual.pdf" width="100%" height="800px" class="border-0"></iframe></div></div>
                </div>
                <div id="puntualidad-agosto-section" class="content-section">
                    <div class="card">
                        <div class="card-header d-flex align-items-center justify-content-center"><i class="fas fa-clock-check fa-2x text-primary me-3"></i><h2 class="mb-0">PUNTUALIDAD - AGOSTO</h2></div>
                        <div class="card-body pdf-container"><a href="#" class="pdf-zoom-btn" title="Ampliar PDF"><i class="fas fa-search-plus"></i></a><iframe src="pdfs/puntualidad_agosto.pdf" width="100%" height="800px" class="border-0"></iframe></div>
                    </div>
                </div>
                
                <div id="comparativa-section" class="content-section">
                     <div class="card border-0">
                        <div class="card-header bg-transparent"><h2 class="mb-0">Análisis Comparativo</h2></div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-12">
                                    <div class="pdf-preview-item">
                                        <h5 class="mb-2">Operatividad de Aerolíneas</h5>
                                        <div class="pdf-preview-container shadow-sm">
                                            <iframe id="pdf-preview-2" src="pdfs/operatividad_aerolineas.pdf"></iframe>
                                        </div>
                                        <button class="btn btn-outline-primary w-100 mt-2" data-fullscreen-target="#pdf-preview-2"><i class="fas fa-expand me-2"></i>Ver en Pantalla Completa</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>
    
    <div id="pdf-lightbox" class="pdf-lightbox hidden">
        <button id="lightbox-close" class="lightbox-close">&times;</button>
        <div id="lightbox-content" class="lightbox-content"></div>
    </div>

        <!-- Toast for actions -->
        <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 2050">
            <div id="action-toast" class="toast align-items-center text-bg-primary border-0" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="d-flex">
                    <div class="toast-body">Filtros limpiados</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
                </div>
            </div>
        </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="script.js"></script>
</body>
</html>